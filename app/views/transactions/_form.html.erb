<%= form_tag transactions_path, method: "post", id: "payment-form" do %>
  <div id="dropin"></div>
  <%= hidden_field_tag :request_id, params[:request_id] %>
  <%= hidden_field_tag :amount_paid, params[:amount_paid] %>
  <input type="submit" class="btn success-color" value="Pay $<%=params[:amount_paid]%>0">
<% end %>

<script src="https://js.braintreegateway.com/js/braintree-2.27.0.min.js"></script>
<script type="text/javascript">

  // $(document).on('turbolinks:load', setupBT);

  // function setupBT() {
  //   var checkout = new Demo({
  //     formID: 'payment-form'
  //   })
  //
  //   braintree.setup("<%=@client_token%>", 'dropin', {
  //     container: 'dropin'
  //   });
  // }

  (function () {

    var client_token = "<%= @client_token %>";
    braintree.setup(client_token, "dropin", {
      container: "dropin"
    });
  })()

</script>
